<!-- src/app/shared/pages/user-guide/user-guide.component.html -->
<!-- ACCORDION MODE: Only one section open at a time + Floating Navigation Menu -->

<div class="min-h-screen bg-slate-50">
  <!-- Hero Section -->
  <div class="bg-white border-b-4 border-teal-600 py-12 px-4 lg:px-8">
    <div class="max-w-6xl mx-auto">
      <div class="mb-6">
        <button
          (click)="goBack()"
          class="inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white font-bold text-xs uppercase tracking-widest rounded-lg mb-4 border-2 border-teal-700 hover:bg-teal-700 active:bg-teal-800 transition-all"
        >
          <lucide-angular [img]="ArrowLeftIcon" size="16"></lucide-angular>
          Go Back
        </button>
      </div>

      <h1 class="text-4xl lg:text-5xl font-black text-slate-900 mb-3">
        {{ content.intro.title }}
      </h1>
      <p class="text-xl text-teal-600 font-bold mb-4">
        {{ content.intro.subtitle }}
      </p>
      <p class="text-lg text-slate-600 max-w-3xl leading-relaxed">
        {{ content.intro.description }}
      </p>
    </div>
  </div>

  <!-- Main Content -->
  <div class="max-w-4xl mx-auto px-4 lg:px-8 py-12">
    <!-- Accordion Sections -->
    <div class="space-y-4">
      @for (section of content.sections; track section.id) {
      <div [id]="section.id" class="scroll-mt-20">
        <!-- Section Header (Click to expand/collapse) -->
        <button
          (click)="toggleSection(section.id)"
          class="w-full p-6 text-left bg-white border-3 border-slate-300 rounded-2xl hover:border-teal-400 hover:bg-teal-50/30 transition-all duration-200"
          [class.border-teal-600]="expandedSection() === section.id"
          [class.bg-teal-50]="expandedSection() === section.id"
        >
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <div
                class="w-12 h-12 rounded-lg flex items-center justify-center font-black text-xl flex-shrink-0 transition-all"
                [class.bg-teal-600]="expandedSection() === section.id"
                [class.text-white]="expandedSection() === section.id"
                [class.bg-slate-100]="expandedSection() !== section.id"
                [class.text-slate-600]="expandedSection() !== section.id"
              >
                {{ section.id.charAt(0).toUpperCase() }}
              </div>

              <div>
                <h2
                  class="text-2xl font-black text-slate-900 transition-colors"
                  [class.text-teal-700]="expandedSection() === section.id"
                >
                  {{ section.title }}
                </h2>
                @if (section.intro && expandedSection() !== section.id) {
                <p class="text-sm text-slate-600 mt-1 line-clamp-2">
                  {{ section.intro }}
                </p>
                }
              </div>
            </div>

            <lucide-angular
              [img]="ChevronDownIcon"
              size="24"
              class="text-slate-600 flex-shrink-0 transition-transform duration-300"
              [style.transform]="
                expandedSection() === section.id ? 'rotate(180deg)' : ''
              "
            ></lucide-angular>
          </div>
        </button>

        <!-- Expanded Content -->
        @if (expandedSection() === section.id) {
        <div
          class="bg-white border-3 border-t-0 border-slate-300 px-6 pb-6 rounded-b-2xl space-y-6 animate-fadeIn"
          [class.border-teal-600]="expandedSection() === section.id"
        >
          <!-- Section Description -->
          @if (section.intro) {
          <div class="p-4 bg-teal-50 border-l-4 border-teal-600 rounded-lg">
            <p class="text-slate-700 leading-relaxed">{{ section.intro }}</p>
          </div>
          }

          <!-- Key Elements -->
          @if (section.elements) {
          <div>
            <h3 class="font-bold text-slate-900 uppercase tracking-tight mb-3">
              Key Elements
            </h3>
            <div class="space-y-2">
              @for (element of section.elements; track element) {
              <div
                class="flex items-start gap-3 p-3 bg-slate-50 rounded-lg border-l-2 border-teal-600"
              >
                <span class="text-teal-600 font-bold mt-1">â–¸</span>
                <span class="text-slate-700">{{ element }}</span>
              </div>
              }
            </div>
          </div>
          }

          <!-- Subsections/Details -->
          @if (section.subsections) {
          <div class="space-y-3">
            @for (subsection of section.subsections; track subsection.title) {
            <div
              class="p-4 bg-slate-50 rounded-lg border border-slate-200 hover:border-teal-300 transition-all"
            >
              <h4 class="font-bold text-slate-900 mb-2">
                {{ subsection.title }}
              </h4>
              @if (subsection.description) {
              <p class="text-sm text-slate-700 mb-2">
                {{ subsection.description }}
              </p>
              } @if (subsection.content) {
              <ul class="space-y-1">
                @for (item of subsection.content; track item) {
                <li class="text-sm text-slate-700 flex items-start gap-2">
                  <span class="text-teal-600 font-bold">âœ“</span>
                  {{ item }}
                </li>
                }
              </ul>
              } @if (subsection.notes) {
              <div class="mt-3 pt-3 border-t border-slate-300">
                @for (note of subsection.notes; track note) {
                <div class="text-xs text-amber-800 mb-1">
                  <span class="font-bold">ðŸ“Œ</span> {{ note }}
                </div>
                }
              </div>
              }
            </div>
            }
          </div>
          }

          <!-- Features/Benefits Lists -->
          @if (section.features) {
          <div>
            <h3 class="font-bold text-slate-900 uppercase tracking-tight mb-3">
              Features
            </h3>
            <div class="space-y-2">
              @for (feature of section.features; track feature) {
              <div class="flex items-start gap-2 text-sm text-slate-700">
                <span class="text-teal-600">â–¸</span>
                {{ feature }}
              </div>
              }
            </div>
          </div>
          } @if (section.benefits) {
          <div>
            <h3 class="font-bold text-slate-900 uppercase tracking-tight mb-3">
              Benefits
            </h3>
            <div class="space-y-2">
              @for (benefit of section.benefits; track benefit) {
              <div class="flex items-start gap-2 text-sm text-slate-700">
                <span class="text-green-600">âœ“</span>
                {{ benefit }}
              </div>
              }
            </div>
          </div>
          }

          <!-- Data Room Uses -->
          @if (section.uses) {
          <div>
            <h3 class="font-bold text-slate-900 uppercase tracking-tight mb-3">
              Use Cases
            </h3>
            <div class="space-y-2">
              @for (use of section.uses; track use.title) {
              <div
                class="p-3 bg-gradient-to-r from-teal-50 to-emerald-50 rounded-lg border-l-4 border-teal-600"
              >
                <h5 class="font-semibold text-teal-900 text-sm mb-1">
                  {{ use.title }}
                </h5>
                <p class="text-xs text-teal-800">{{ use.description }}</p>
              </div>
              }
            </div>
          </div>
          }

          <!-- Settings Sections -->
          @if (section.sections) {
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            @for (subsec of section.sections; track subsec.title) {
            <div class="p-4 bg-slate-50 rounded-lg border border-slate-200">
              <h4 class="font-bold text-slate-900 mb-2 text-sm">
                {{ subsec.title }}
              </h4>
              <p class="text-xs text-slate-700">{{ subsec.description }}</p>
            </div>
            }
          </div>
          }
        </div>
        }
      </div>
      }
    </div>
  </div>

  <!-- Floating Navigation Menu (Bottom-Right) -->
  <div class="fixed bottom-8 right-8 z-40">
    <!-- Menu Button -->
    <button
      (click)="showFloatingMenu.set(!showFloatingMenu())"
      class="w-14 h-14 rounded-full bg-teal-600 text-white shadow-lg hover:bg-teal-700 active:scale-95 transition-all flex items-center justify-center border-2 border-teal-700"
      [class.scale-110]="showFloatingMenu()"
      title="Navigation menu"
    >
      @if (showFloatingMenu()) {
      <lucide-angular [img]="XIcon" size="24"></lucide-angular>
      } @else {
      <lucide-angular [img]="MenuIcon" size="24"></lucide-angular>
      }
    </button>

    <!-- Menu Overlay (Dropdown) -->
    @if (showFloatingMenu()) {
    <div
      class="absolute bottom-20 right-0 w-72 bg-white rounded-2xl shadow-xl border-3 border-slate-300 p-6 animate-fadeIn"
    >
      <h3
        class="font-black text-slate-900 uppercase tracking-tight mb-4 text-sm"
      >
        Sections
      </h3>

      <nav class="space-y-2 max-h-96 overflow-y-auto">
        @for (section of content.sections; track section.id) {
        <button
          (click)="scrollToSection(section.id)"
          [class.bg-teal-100]="expandedSection() === section.id"
          [class.border-l-4]="expandedSection() === section.id"
          [class.border-teal-600]="expandedSection() === section.id"
          [class.text-teal-700]="expandedSection() === section.id"
          class="w-full text-left px-4 py-3 rounded-lg text-sm font-semibold text-slate-700 hover:bg-slate-100 transition-all duration-200"
        >
          {{ section.title }}
        </button>
        }
      </nav>

      <div class="mt-4 pt-4 border-t border-slate-200 text-xs text-slate-600">
        <p>{{ content.sections.length }} sections total</p>
      </div>
    </div>
    }

    <!-- Backdrop (Click to close) -->
    @if (showFloatingMenu()) {
    <button
      (click)="showFloatingMenu.set(false)"
      class="fixed inset-0 z-30"
    ></button>
    }
  </div>

  <!-- Progress Indicator (Bottom) -->
  <div class="fixed bottom-0 left-0 right-0 h-1 bg-slate-200 z-30">
    <div
      class="h-full bg-gradient-to-r from-teal-400 to-teal-600 transition-all duration-500"
      [style.width.%]="progressWidth()"
    ></div>
  </div>
</div>
