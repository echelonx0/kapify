<div
  class="bg-white border border-slate-200 rounded-xl p-5 hover:border-slate-300 transition-all duration-200 hover:shadow-sm"
>
  <!-- Header: Match Grade & Title -->
  <div class="flex items-start justify-between gap-4 mb-4">
    <div class="flex-1 min-w-0">
      <h3 class="text-sm font-semibold text-slate-900 line-clamp-2">
        {{ opportunity.title }}
      </h3>
      <p class="text-xs text-slate-600 mt-1">
        {{
          opportunity["funderName"] || opportunity["funder"]?.name || "Funder"
        }}
      </p>
    </div>

    <!-- Match Grade Badge -->
    <div class="flex-shrink-0 text-right">
      <div class="text-lg font-bold" [class]="getMatchColor()">
        {{ getMatchGrade() }}
      </div>
      <p class="text-xs text-slate-500 mt-0.5">Match</p>
    </div>
  </div>

  <!-- Match Score Bar -->
  <div class="h-1.5 bg-slate-100 rounded-full overflow-hidden mb-4">
    <div
      [class]="
        'h-full rounded-full transition-all duration-700 bg-gradient-to-r ' +
        getProgressGradient()
      "
      [style.width.%]="matchScore"
    ></div>
  </div>

  <!-- Opportunity Details -->
  <div class="space-y-3 mb-4">
    <!-- Funding Amount -->
    <div class="flex items-center justify-between text-xs">
      <span class="text-slate-600">Funding Range</span>
      <span class="font-medium text-slate-900">
        {{ formatAmount(opportunity.minInvestment) }} -
        {{ formatAmount(opportunity.maxInvestment) }}
      </span>
    </div>

    <!-- Type -->
    <div class="flex items-center justify-between text-xs">
      <span class="text-slate-600">Type</span>
      <span class="font-medium text-slate-900">
        {{ getTypeLabel(opportunity.fundingType) }}
      </span>
    </div>
  </div>

  <!-- Scoring Breakdown Trigger -->
  <button
    (click)="onViewScoring()"
    class="w-full mb-4 p-3 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 hover:border-slate-300 transition-colors text-left"
  >
    <p class="text-xs font-semibold text-slate-900 mb-1">
      How we scored this match
    </p>
    <p class="text-xs text-slate-600">
      See breakdown by industry, funding, stage & location â†’
    </p>
  </button>

  <!-- Action Buttons -->
  <div class="flex gap-2">
    <!-- View Details -->
    <button
      (click)="onViewDetails()"
      class="flex-1 px-3 py-2.5 bg-slate-100 text-slate-900 text-xs font-medium rounded-lg hover:bg-slate-200 transition-colors"
    >
      Details
    </button>

    <!-- Apply / Sign In / Locked -->
    @if (canApply) {
    <button
      (click)="onApply()"
      class="flex-1 px-3 py-2.5 bg-teal-500 text-white text-xs font-medium rounded-lg hover:bg-teal-600 active:bg-teal-700 transition-colors flex items-center justify-center gap-2"
    >
      <span>Apply</span>
      <lucide-icon [img]="ArrowRightIcon" [size]="14" />
    </button>
    } @else { @if (reasonMessage.includes('Sign')) {
    <button
      (click)="onSignInToApply()"
      class="flex-1 px-3 py-2.5 bg-slate-200 text-slate-700 text-xs font-medium rounded-lg hover:bg-slate-300 transition-colors flex items-center justify-center gap-2"
    >
      <lucide-icon [img]="LogInIcon" [size]="14" />
      <span class="hidden xs:inline">Sign In</span>
    </button>
    } @else {
    <div
      class="flex-1 px-3 py-2.5 bg-slate-100 text-slate-600 text-xs font-medium rounded-lg flex items-center justify-center gap-2 cursor-not-allowed opacity-60"
      title="{{ reasonMessage }}"
    >
      <lucide-icon [img]="LockIcon" [size]="14" />
      <span class="hidden xs:inline">Locked</span>
    </div>
    } }
  </div>

  <!-- Reason Message (if locked) -->
  <!-- @if (!canApply && reasonMessage) {
  <p class="text-xs text-slate-600 mt-2 text-center">
    {{ reasonMessage }}
  </p>
  } -->
</div>
