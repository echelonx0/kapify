<div (click)="closeAllDropdowns($event)" class="mt-12">
  <!-- Filter Header -->
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"
  >
    <!-- Clear All Button -->
    <button
      *ngIf="hasActiveFilters()"
      (click)="clearAllFilters()"
      class="inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-slate-700 hover:text-slate-900 hover:bg-slate-100 rounded-xl transition-colors duration-200 border border-slate-200"
    >
      <lucide-icon [img]="RefreshCwIcon" [size]="16" />
      Clear All
    </button>
  </div>

  <!-- Horizontal Filters Grid - Mobile Responsive -->
  <div
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 lg:gap-4 mb-6"
  >
    <!-- Funding Type Filter -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-slate-900">
        Funding Type
      </label>
      <div class="relative">
        <button
          (click)="toggleDropdown('fundingType', $event)"
          class="w-full px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-left text-sm text-slate-900 hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-0 focus:border-transparent transition-all duration-200"
        >
          <span *ngIf="activeFundingTypes.length === 0" class="text-slate-500"
            >Select types...</span
          >
          <span *ngIf="activeFundingTypes.length === 1">{{
            getOptionLabel(fundingTypes, activeFundingTypes[0])
          }}</span>
          <span *ngIf="activeFundingTypes.length > 1" class="text-slate-700"
            >{{ activeFundingTypes.length }} selected</span
          >
          <lucide-icon
            [img]="ChevronDownIcon"
            [size]="16"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"
          />
        </button>

        <div
          *ngIf="dropdownStates.fundingType"
          class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-md"
        >
          <div class="p-2 space-y-1 max-h-48 overflow-y-auto">
            <label
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150 border-b border-slate-200"
            >
              <input
                type="checkbox"
                [checked]="
                  activeFundingTypes.length === fundingTypes.length &&
                  fundingTypes.length > 0
                "
                [indeterminate]="
                  activeFundingTypes.length > 0 &&
                  activeFundingTypes.length < fundingTypes.length
                "
                (change)="selectAllFundingTypes()"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm font-semibold text-slate-900"
                >Select All</span
              >
            </label>
            <label
              *ngFor="let type of fundingTypes"
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="checkbox"
                [checked]="activeFundingTypes.includes(type.value)"
                (change)="toggleFundingType(type.value)"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm text-slate-900">{{ type.label }}</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Industry Filter -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-slate-900">
        Industry
      </label>
      <div class="relative">
        <button
          (click)="toggleDropdown('industry', $event)"
          class="w-full px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-left text-sm text-slate-900 hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-0 focus:border-transparent transition-all duration-200"
        >
          <span *ngIf="activeIndustries.length === 0" class="text-slate-500"
            >Select industries...</span
          >
          <span *ngIf="activeIndustries.length === 1">{{
            getOptionLabel(industries, activeIndustries[0])
          }}</span>
          <span *ngIf="activeIndustries.length > 1" class="text-slate-700"
            >{{ activeIndustries.length }} selected</span
          >
          <lucide-icon
            [img]="ChevronDownIcon"
            [size]="16"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"
          />
        </button>

        <div
          *ngIf="dropdownStates.industry"
          class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-md"
        >
          <div class="p-2 space-y-1 max-h-48 overflow-y-auto">
            <label
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150 border-b border-slate-200"
            >
              <input
                type="checkbox"
                [checked]="
                  activeIndustries.length === industries.length &&
                  industries.length > 0
                "
                [indeterminate]="
                  activeIndustries.length > 0 &&
                  activeIndustries.length < industries.length
                "
                (change)="selectAllIndustries()"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm font-semibold text-slate-900"
                >Select All</span
              >
            </label>
            <label
              *ngFor="let industry of industries"
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="checkbox"
                [checked]="activeIndustries.includes(industry.value)"
                (change)="toggleIndustry(industry.value)"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm text-slate-900">{{
                industry.label
              }}</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Currency Filter -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-slate-900">
        Currency
      </label>
      <div class="relative">
        <button
          (click)="toggleDropdown('currency', $event)"
          class="w-full px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-left text-sm text-slate-900 hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-0 focus:border-transparent transition-all duration-200"
        >
          <span *ngIf="activeCurrencies.length === 0" class="text-slate-500"
            >Select currencies...</span
          >
          <span *ngIf="activeCurrencies.length === 1">{{
            activeCurrencies[0]
          }}</span>
          <span *ngIf="activeCurrencies.length > 1" class="text-slate-700"
            >{{ activeCurrencies.length }} selected</span
          >
          <lucide-icon
            [img]="ChevronDownIcon"
            [size]="16"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"
          />
        </button>

        <div
          *ngIf="dropdownStates.currency"
          class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-md"
        >
          <div class="p-2 space-y-1 max-h-48 overflow-y-auto">
            <label
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150 border-b border-slate-200"
            >
              <input
                type="checkbox"
                [checked]="
                  activeCurrencies.length === currencies.length &&
                  currencies.length > 0
                "
                [indeterminate]="
                  activeCurrencies.length > 0 &&
                  activeCurrencies.length < currencies.length
                "
                (change)="selectAllCurrencies()"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm font-semibold text-slate-900"
                >Select All</span
              >
            </label>
            <label
              *ngFor="let currency of currencies"
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="checkbox"
                [checked]="activeCurrencies.includes(currency.value)"
                (change)="toggleCurrency(currency.value)"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300 rounded"
              />
              <span class="ml-3 text-sm text-slate-900">{{
                currency.label
              }}</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Amount Range - Min -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-slate-900">
        Min Amount
      </label>
      <div class="relative">
        <button
          (click)="toggleDropdown('minAmount', $event)"
          class="w-full px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-left text-sm text-slate-900 hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-0 focus:border-transparent transition-all duration-200"
        >
          <span *ngIf="!minAmount" class="text-slate-500">Select...</span>
          <span *ngIf="minAmount">{{ minAmount }}</span>
          <lucide-icon
            [img]="ChevronDownIcon"
            [size]="16"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"
          />
        </button>

        <div
          *ngIf="dropdownStates.minAmount"
          class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-md"
        >
          <div class="p-2 space-y-1 max-h-48 overflow-y-auto">
            <label
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="radio"
                name="minAmount"
                [checked]="!minAmount"
                (change)="setMinAmount('')"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300"
              />
              <span class="ml-3 text-sm text-slate-900">Any</span>
            </label>
            <label
              *ngFor="let range of minAmountRanges"
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="radio"
                name="minAmount"
                [checked]="minAmount === range.value"
                (change)="setMinAmount(range.value)"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300"
              />
              <span class="ml-3 text-sm text-slate-900">{{ range.label }}</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Amount Range - Max -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-slate-900">
        Max Amount
      </label>
      <div class="relative">
        <button
          (click)="toggleDropdown('maxAmount', $event)"
          class="w-full px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-left text-sm text-slate-900 hover:border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-0 focus:border-transparent transition-all duration-200"
        >
          <span *ngIf="!maxAmount" class="text-slate-500">Select...</span>
          <span *ngIf="maxAmount">{{ maxAmount }}</span>
          <lucide-icon
            [img]="ChevronDownIcon"
            [size]="16"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"
          />
        </button>

        <div
          *ngIf="dropdownStates.maxAmount"
          class="absolute z-50 w-full mt-1 bg-white border border-slate-200 rounded-xl shadow-md"
        >
          <div class="p-2 space-y-1 max-h-48 overflow-y-auto">
            <label
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="radio"
                name="maxAmount"
                [checked]="!maxAmount"
                (change)="setMaxAmount('')"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300"
              />
              <span class="ml-3 text-sm text-slate-900">No limit</span>
            </label>
            <label
              *ngFor="let range of maxAmountRanges"
              class="flex items-center p-2 hover:bg-slate-50 rounded-lg cursor-pointer transition-colors duration-150"
            >
              <input
                type="radio"
                name="maxAmount"
                [checked]="maxAmount === range.value"
                (change)="setMaxAmount(range.value)"
                class="h-4 w-4 text-teal-500 focus:ring-teal-500 border-slate-300"
              />
              <span class="ml-3 text-sm text-slate-900">{{ range.label }}</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Active Filters Summary -->
  <div
    *ngIf="hasActiveFilters()"
    class="bg-teal-50 border border-teal-300/50 rounded-xl p-4"
  >
    <div
      class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"
    >
      <div class="flex items-start flex-wrap gap-3">
        <span class="text-sm font-semibold text-teal-900 whitespace-nowrap"
          >Active Filters:</span
        >
        <div class="flex flex-wrap gap-2">
          <span
            *ngFor="let type of activeFundingTypes"
            class="inline-flex items-center gap-1 px-3 py-1 bg-white text-teal-700 rounded-lg text-sm border border-teal-300/50 font-medium"
          >
            {{ getOptionLabel(fundingTypes, type) }}
            <button
              (click)="toggleFundingType(type)"
              class="ml-1 hover:text-teal-900 text-teal-500 font-bold text-lg leading-none"
            >
              ×
            </button>
          </span>
          <span
            *ngFor="let industry of activeIndustries"
            class="inline-flex items-center gap-1 px-3 py-1 bg-white text-teal-700 rounded-lg text-sm border border-teal-300/50 font-medium"
          >
            {{ getOptionLabel(industries, industry) }}
            <button
              (click)="toggleIndustry(industry)"
              class="ml-1 hover:text-teal-900 text-teal-500 font-bold text-lg leading-none"
            >
              ×
            </button>
          </span>
          <span
            *ngFor="let currency of activeCurrencies"
            class="inline-flex items-center gap-1 px-3 py-1 bg-white text-teal-700 rounded-lg text-sm border border-teal-300/50 font-medium"
          >
            {{ currency }}
            <button
              (click)="toggleCurrency(currency)"
              class="ml-1 hover:text-teal-900 text-teal-500 font-bold text-lg leading-none"
            >
              ×
            </button>
          </span>
          <span
            *ngIf="minAmount || maxAmount"
            class="inline-flex items-center gap-1 px-3 py-1 bg-white text-teal-700 rounded-lg text-sm border border-teal-300/50 font-medium"
          >
            {{ formatAmountRange() }}
            <button
              (click)="clearAmountRange()"
              class="ml-1 hover:text-teal-900 text-teal-500 font-bold text-lg leading-none"
            >
              ×
            </button>
          </span>
        </div>
      </div>

      <button
        (click)="applyFilters.emit()"
        class="inline-flex items-center justify-center gap-2 px-6 py-2.5 bg-teal-500 text-white font-medium rounded-xl hover:bg-teal-600 active:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition-all duration-200 whitespace-nowrap"
      >
        Apply Filters
      </button>
    </div>
  </div>
</div>
