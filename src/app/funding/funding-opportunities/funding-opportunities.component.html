<div class="min-h-screen bg-neutral-50 mr-6 mt-6">
  <sidebar-nav />

  <!-- Header with Gradient -->
  <div class="rounded-lg p-8 mb-8 bg-gradient-to-r from-slate-600 via-slate-500 to-slate-400 text-white">
    <h1 class="text-3xl font-bold mb-2">Kapify Funding Marketplace</h1>
    <!-- <p class="max-w-2xl text-sm">
      Automate the first stages in funding research and application by connecting SMEs with funders, saving hundreds of millions of Rands in administrative costs each year.
    </p>
    <p class="mt-2 text-sm font-medium">
      ðŸ’° Make Kapify part of your fundraising strategy. Kapify constantly combines your financing requirements with qualifying criteria from hundreds of South African funders and givers. 
      There's no need to go through numerous lists of funders; let Kapify handle the hard work for you.
    </p> -->
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
    <!-- Left: Main Opportunities List -->
    <main class="lg:col-span-3 space-y-6">

      <!-- Loading State -->
      @if (isLoading()) {
        <div class="bg-white rounded-lg border border-neutral-200 p-12 text-center">
          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto mb-4"></div>
          <p class="text-neutral-600">Loading opportunities...</p>
        </div>
      }

      <!-- Empty State -->
      @if (!isLoading() && filteredOpportunities().length === 0) {
        <div class="bg-white rounded-lg border border-neutral-200 p-12 text-center">
          <div class="w-16 h-16 bg-neutral-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <lucide-icon [img]="SearchIcon" [size]="24" class="text-neutral-400" />
          </div>
          <h3 class="text-lg font-medium text-neutral-900 mb-2">No opportunities found</h3>
          <p class="text-neutral-600 mb-4">Try adjusting your search criteria or filters.</p>
          <ui-button variant="outline" (clicked)="clearFilters()">
            Clear all filters
          </ui-button>
        </div>
      }

      <!-- Opportunities List -->
      @if (!isLoading() && filteredOpportunities().length > 0) {
        <div class="space-y-6">
          @for (opportunity of filteredOpportunities(); track opportunity.id) {
            <div class="bg-white rounded-lg border border-neutral-200 p-6 hover:shadow-md transition-shadow">
              <div class="flex items-start justify-between">
                <!-- Info -->
                <div class="flex-1">
                  <div class="flex items-center space-x-4 mb-4">
                    <!-- Placeholder Logo -->
                    <img src="/images/hero.png" alt="logo"
                         class="w-16 h-16 object-cover rounded-lg border" />
                    <div class="flex-1">
                      <h3 class="text-xl font-bold text-neutral-900 mb-1">
                        {{ opportunity.title }}
                      </h3>
                      <div class="flex items-center space-x-2 mb-2">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
                              [class]="getFundingTypeClasses(opportunity.fundingType)">
                          {{ formatFundingType(opportunity.fundingType) }}
                        </span>
                        @for (industry of opportunity.eligibilityCriteria.industries.slice(0, 3); track industry) {
                          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-neutral-100 text-neutral-800">
                            {{ formatIndustry(industry) }}
                          </span>
                        }
                      </div>
                    </div>
                  </div>

                  <p class="text-neutral-600 mb-4">{{ opportunity.shortDescription }}</p>

                  <!-- Key Details -->
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="flex items-center space-x-2">
                      <lucide-icon [img]="DollarSignIcon" [size]="16" class="text-neutral-400" />
                      <div>
                        <div class="text-sm font-medium text-neutral-900">
                          {{ opportunity.currency }} {{ formatAmount(opportunity.minInvestment) }} - {{ formatAmount(opportunity.maxInvestment) }}
                        </div>
                        <div class="text-xs text-neutral-500">Investment Range</div>
                      </div>
                    </div>
                    <div class="flex items-center space-x-2">
                      <lucide-icon [img]="CalendarIcon" [size]="16" class="text-neutral-400" />
                      <div>
                        <div class="text-sm font-medium text-neutral-900">{{ opportunity.decisionTimeframe }} days</div>
                        <div class="text-xs text-neutral-500">Decision Timeline</div>
                      </div>
                    </div>
                    <div class="flex items-center space-x-2">
                      <lucide-icon [img]="UsersIcon" [size]="16" class="text-neutral-400" />
                      <div>
                        <div class="text-sm font-medium text-neutral-900">{{ opportunity.currentApplications }}/{{ opportunity.maxApplications || 'âˆž' }}</div>
                        <div class="text-xs text-neutral-500">Applications</div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Actions -->
                <div class="flex flex-col space-y-2 ml-6">
                  <ui-button variant="primary" (clicked)="applyToOpportunity(opportunity.id)">
                    Apply Now
                  </ui-button>
                  <ui-button variant="outline" (clicked)="viewOpportunityDetails(opportunity.id)">
                    View Details
                  </ui-button>
                </div>
              </div>
            </div>
          }
        </div>
      }
    </main>

    <!-- Right: Filters + Dummy Content -->
    <aside class="space-y-6">
      <!-- Search & Filters -->
      <div class="bg-white rounded-lg border border-neutral-200 p-4">
        <div class="relative mb-4">
          <lucide-icon [img]="SearchIcon" [size]="16" class="absolute left-3 top-2.5 text-neutral-400" />
          <input
            type="text"
            placeholder="Search funding opportunities..."
            [value]="searchQuery()"
            (input)="onSearchChange($event)"
            class="block w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-md sm:text-sm focus:ring-primary-500 focus:border-primary-500"
          />
        </div>

        <div class="space-y-4">
          <select [value]="selectedFundingType()" (change)="onFundingTypeChange($event)"
                  class="w-full px-3 py-2 border rounded-md">
            <option value="">All Types</option>
            <option value="equity">Equity</option>
            <option value="debt">Debt</option>
            <option value="mezzanine">Mezzanine</option>
            <option value="grant">Grant</option>
            <option value="convertible">Convertible</option>
          </select>

          <select [value]="selectedIndustry()" (change)="onIndustryChange($event)"
                  class="w-full px-3 py-2 border rounded-md">
            <option value="">All Industries</option>
            <option value="technology">Technology</option>
            <option value="manufacturing">Manufacturing</option>
            <option value="retail">Retail</option>
          </select>

          <div class="flex space-x-2">
            <input type="number" placeholder="Min"
                   [value]="minAmount()" (input)="onMinAmountChange($event)"
                   class="w-1/2 px-3 py-2 border rounded-md" />
            <input type="number" placeholder="Max"
                   [value]="maxAmount()" (input)="onMaxAmountChange($event)"
                   class="w-1/2 px-3 py-2 border rounded-md" />
          </div>
        </div>
      </div>

      <!-- Dummy Sidebar Content -->
      <div class="bg-white rounded-lg border border-neutral-200 p-4">
        <h4 class="font-medium mb-2">Latest Insights</h4>
        <ul class="space-y-2 text-sm text-neutral-600">
          <li>How SMEs can prepare for funding</li>
          <li>Top 10 grant programs in 2025</li>
          <li>Equity vs Debt: Whatâ€™s best for growth?</li>
        </ul>



      </div>

              <!-- Inline Subscribe Box -->
<div class="subscribe-box max-w-4xl mx-auto mt-12 p-6 rounded-2xl shadow-md bg-white border border-gray-200">
  <h2 class="text-xl font-semibold text-gray-900 mb-2">
    Stay Updated
  </h2>
  <p class="text-gray-600 mb-4">
    Subscribe to receive the latest insights, updates, and tips straight to your inbox.
  </p>
  
  <form class="flex flex-col sm:flex-row gap-3">
    <input 
      type="email" 
      placeholder="Enter your email" 
      class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
      required
    >
    <button 
      type="submit" 
      class="px-6 py-3 rounded-lg bg-primary-600 text-white font-medium hover:bg-blue-700 transition"
    >
      Subscribe
    </button>
  </form>
</div>
    </aside>
  </div>
</div>
