<!-- src/app/SMEs/data-room/data-room.component.html -->
<div class="min-h-screen bg-slate-50 ml-16 mr-2">
  <!-- Main Layout -->
  <div class="flex h-screen bg-slate-50">
    
    <!-- Sidebar Navigation -->
    <app-data-room-sidebar
      [sections]="sections()"
      [activeSection]="activeSection()"
      [permissions]="permissions()"
      [documentCounts]="documentCounts()"
      [sectionStatuses]="sectionStatuses()"
      (selectSection)="navigateToSection($event)"
    />

    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col overflow-hidden">
      
      <!-- Header -->
      <app-data-room-header
        [dataRoom]="dataRoom()"
        [permissions]="permissions()"
        [companyName]="companyName()"
        [isAIAnalyzing]="isAIAnalyzing()"
        [stats]="accessStats()"
        [shareInfo]="shareInfo()"
        (enhanceWithAI)="enhanceWithAI()"
        (export)="exportDataRoom()"
        (share)="openSharingModal()"
        (viewAccessLog)="navigateToSection('access-log')"
        (back)="navigateBack()"
      />

      <!-- Content Scroll Area -->
      <div class="flex-1 overflow-y-auto">
        <div class="max-w-6xl mx-auto px-8 py-8">
          
          <!-- Loading State -->
          @if (isLoading()) {
            <div class="flex flex-col items-center justify-center py-16">
              <div class="w-10 h-10 rounded-full border-2 border-slate-200 border-t-orange-500 animate-spin mb-4"></div>
              <p class="text-slate-600 font-medium">Loading data room...</p>
            </div>
          }
          
          <!-- Error State -->
          @else if (error()) {
            <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-12 text-center">
              <div class="w-16 h-16 bg-red-100 rounded-xl flex items-center justify-center mx-auto mb-4">
                <lucide-icon 
                  [img]="AlertCircleIcon" 
                  [size]="32" 
                  class="text-red-600"
                />
              </div>
              <h3 class="text-lg font-bold text-slate-900 mb-2">Failed to load data room</h3>
              <p class="text-slate-600 mb-6">{{ error() }}</p>
              <button
                (click)="loadDataRoom()"
                class="px-6 py-2.5 bg-orange-500 text-white font-medium rounded-xl hover:bg-orange-600 active:bg-orange-700 transition-colors duration-200"
              >
                Try Again
              </button>
            </div>
          }
          
          <!-- Section Content -->
          @else {
            @switch (activeSection()) {
              
              @case ('executive') {
                <app-executive-summary
                  [companyInfo]="companyInfo()"
                  [financialMetrics]="financialMetrics()"
                  [fundingInfo]="fundingInfo()"
                  [marketIntelligence]="marketIntelligence()"
                />
              }
              
              @case ('financials') {
                <app-financial-dashboard
                  [financialMetrics]="financialMetrics()"
                />
              }
              
              @case ('documents') {
                <app-document-repository
                  [dataRoomId]="dataRoomId()"
                  [permissions]="permissions()"
                  [sections]="sections()"
                />
              }
              
              @case ('management') {
                <app-management-team
                  [managementTeam]="managementTeam()"
                />
              }
              
              @case ('market') {
                <app-market-analysis
                  [marketIntelligence]="marketIntelligence()"
                  [isAnalyzing]="isAIAnalyzing"
                  (enhanceWithAI)="enhanceWithAI()"
                />
              }
              
              @case ('legal') {
                <app-legal-compliance
                  [companyInfo]="companyInfo()"
                />
              }
              
              @case ('access-requests') {
                <app-access-requests-list
                  [organizationId]="currentUserId()"
                />
              }
              
              @case ('access-log') {
                <app-access-log
                  [dataRoomId]="dataRoomId()"
                />
              }
              
              @case ('analytics') {
                <app-access-analytics-dashboard
                  [dataRoomId]="dataRoomId()"
                />
              }
              
              @default {
                <app-executive-summary
                  [companyInfo]="companyInfo()"
                  [financialMetrics]="financialMetrics()"
                  [fundingInfo]="fundingInfo()"
                  [marketIntelligence]="marketIntelligence()"
                />
              }
            }
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <app-sharing-modal
    (shared)="onDataRoomShared()"
    (closed)="onModalClosed()"
  />

  <app-access-request-modal
    (submitted)="onAccessRequestSubmitted()"
    (closed)="onModalClosed()"
  />
</div>