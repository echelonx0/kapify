    <div class="space-y-6">
      <!-- Header Section -->
      <ui-card>
        <div class="flex items-start justify-between">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center">
              <lucide-icon [img]="FileTextIcon" [size]="20" class="text-primary-600" />
            </div>
            <div>
              <h2 class="text-xl font-semibold text-neutral-900">Business Plan</h2>
              <p class="text-neutral-600 mt-1">
                Provide a detailed description of your business strategy, market analysis, and growth plans.
              </p>
            </div>
          </div>
          <div class="text-right">
            <div class="text-sm text-neutral-500">Progress</div>
            <div class="text-lg font-semibold text-primary-600">{{ getCompletionPercentage() }}%</div>
          </div>
        </div>
        
        <!-- Upload Business Plan Document -->
        <div class="mt-6 pt-6 border-t border-neutral-200">
          <h3 class="text-sm font-medium text-neutral-900 mb-3">Upload Complete Business Plan</h3>
          <div class="flex items-center space-x-4">
            <ui-button variant="outline" size="sm" (clicked)="triggerFileUpload()">
              <lucide-icon [img]="UploadIcon" [size]="16" class="mr-2" />
              Choose File
            </ui-button>
            @if (uploadedDocument()) {
              <span class="text-sm text-neutral-600">{{ uploadedDocument()?.name }}</span>
            } @else {
              <span class="text-sm text-neutral-500">No file selected</span>
            }
          </div>
          <p class="text-xs text-neutral-500 mt-2">
            Upload your complete business plan document (PDF, DOC, or DOCX format)
          </p>
        </div>
      </ui-card>

      <!-- Business Plan Sections -->
      @for (section of sections(); track section.id) {
        <ui-section-card
          [title]="section.title"
          [description]="section.description"
          [required]="section.required"
          [completed]="section.completed"
          [hasData]="hasFormData(section)"
          [expanded]="section.expanded"
          [saving]="getSectionSaving(section.id)"
          [lastSaved]="getSectionLastSaved(section.id)"
          (expandedChange)="toggleSection(section.id, $event)"
          (saveDraft)="saveSectionDraft(section.id)"
          (saveAndValidate)="saveSectionAndValidate(section.id)"
        >
          <lucide-icon slot="icon" [img]="section.icon" [size]="16" />
          
          @switch (section.id) {
            @case ('executive-summary') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Executive Summary"
                  placeholder="Provide a concise overview of your business, including your mission, vision, key objectives, and what makes your business unique..."
                  [rows]="6"
                  [maxLength]="1000"
                  [showCharCount]="true"
                  formControlName="executiveSummary"
                  [required]="true"
                  hint="This is the first thing investors will read. Make it compelling and clear."
                />
                
                <ui-textarea
                  label="Business Concept"
                  placeholder="Describe your business concept, the problem you solve, and your solution..."
                  [rows]="4"
                  formControlName="businessConcept"
                  [required]="true"
                />
                
                <ui-input
                  label="Key Success Factors"
                  placeholder="e.g., Experienced team, proprietary technology, strong partnerships"
                  formControlName="keySuccessFactors"
                  hint="Separate multiple factors with commas"
                />
              </form>
            }
            
            @case ('market-analysis') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Market Research Methodology"
                  placeholder="How was the market research conducted? (Desktop research, surveys, focus groups, research firms, etc.)"
                  [rows]="4"
                  formControlName="researchMethodology"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Industry Analysis"
                  placeholder="Review industry information to assess the current and potential growth prospects of the market in which your business operates..."
                  [rows]="5"
                  formControlName="industryAnalysis"
                  [required]="true"
                />
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <ui-input
                    label="Market Size (ZAR)"
                    type="number"
                    placeholder="e.g., 5000000"
                    formControlName="marketSize"
                    hint="Total addressable market in South African Rand"
                  />
                  <ui-input
                    label="Annual Growth Rate (%)"
                    type="number"
                    placeholder="e.g., 15"
                    formControlName="growthRate"
                    hint="Expected annual market growth percentage"
                  />
                </div>
                
                <ui-textarea
                  label="Target Market Definition"
                  placeholder="Who is your target market? How big is it? What is your current share and what is the target that you are after post investment?"
                  [rows]="4"
                  formControlName="targetMarket"
                  [required]="true"
                />
              </form>
            }
            
            @case ('marketing-strategy') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Sales and Marketing Strategy"
                  placeholder="Assess the overall sales and marketing strategy. How realistic and achievable is it? Must be based on secured contracts, letters of intent and/or verifiable market research."
                  [rows]="5"
                  formControlName="salesStrategy"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Distribution Channels"
                  placeholder="Description of distribution channels used/to be used to reach the target market"
                  [rows]="4"
                  formControlName="distributionChannels"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Marketing Campaigns & Metrics"
                  placeholder="Does the entity have any marketing campaign? What are the metrics and milestones."
                  [rows]="4"
                  formControlName="marketingCampaigns"
                />
                
                <ui-textarea
                  label="Revenue Assumptions Assessment"
                  placeholder="Assess the reasonableness of the assumptions for the revenue projects"
                  [rows]="4"
                  formControlName="revenueAssumptions"
                  [required]="true"
                />
              </form>
            }
            
            @case ('competitive-analysis') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Main Competitors"
                  placeholder="Identify your main competitors and analyze their strengths and weaknesses. Explain how your business differentiates itself from the competition."
                  [rows]="5"
                  formControlName="competitors"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Competitive Advantages"
                  placeholder="What are your key competitive advantages? How do you maintain these advantages? What makes your solution unique?"
                  [rows]="4"
                  formControlName="competitiveAdvantages"
                  [required]="true"
                />
                
                <ui-input
                  label="Market Position"
                  placeholder="e.g., Market Leader, Challenger, Niche Player"
                  formControlName="marketPosition"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Barriers to Entry"
                  placeholder="What barriers exist for new competitors entering your market? How do these barriers protect your business?"
                  [rows]="3"
                  formControlName="barriersToEntry"
                />
              </form>
            }
            
            @case ('operations') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Goods and Services"
                  placeholder="Provide a detailed description of the products or services your business offers. Explain the unique value proposition and the benefits to your customers."
                  [rows]="5"
                  formControlName="goodsServices"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Operational Processes"
                  placeholder="Describe your key operational processes, production methods, quality control measures, and service delivery mechanisms."
                  [rows]="4"
                  formControlName="operationalProcesses"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Supply Chain Management"
                  placeholder="Detail your supply chain and key suppliers. Explain your procurement strategy and supplier relationships."
                  [rows]="4"
                  formControlName="supplyChain"
                />
                
                <ui-textarea
                  label="Technology & Systems"
                  placeholder="Describe the technology, equipment, and systems critical to your operations."
                  [rows]="3"
                  formControlName="technology"
                />
              </form>
            }
            
            @case ('financial-projections') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Financial Projections Overview"
                  placeholder="Provide an overview of your financial projections, including key assumptions and methodology used."
                  [rows]="4"
                  formControlName="projectionsOverview"
                  [required]="true"
                />
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <ui-input
                    label="Year 1 Revenue Projection (ZAR)"
                    type="number"
                    placeholder="e.g., 2500000"
                    formControlName="year1Revenue"
                    [required]="true"
                  />
                  <ui-input
                    label="Year 3 Revenue Projection (ZAR)"
                    type="number"
                    placeholder="e.g., 8500000"
                    formControlName="year3Revenue"
                    [required]="true"
                  />
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <ui-input
                    label="Break-even Timeline (months)"
                    type="number"
                    placeholder="e.g., 18"
                    formControlName="breakEvenTimeline"
                    [required]="true"
                  />
                  <ui-input
                    label="Expected ROI (%)"
                    type="number"
                    placeholder="e.g., 25"
                    formControlName="expectedROI"
                  />
                </div>
                
                <ui-textarea
                  label="Key Financial Assumptions"
                  placeholder="List and justify the key assumptions underlying your financial projections (pricing, customer acquisition, cost structure, etc.)"
                  [rows]="4"
                  formControlName="financialAssumptions"
                  [required]="true"
                />
              </form>
            }
            
            @case ('legal-compliance') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Judgements Against Company/Directors"
                  placeholder="Are there any Judgements against the company/director(s)?"
                  [rows]="3"
                  formControlName="judgements"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Pending Legal Disputes"
                  placeholder="Are there any pending legal disputes against/by the company/director(s)?"
                  [rows]="3"
                  formControlName="legalDisputes"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Patent and Trademark Disputes"
                  placeholder="Are there any patent and trademark disputes in progress?"
                  [rows]="3"
                  formControlName="patentDisputes"
                  [required]="true"
                />
                
                <ui-textarea
                  label="Regulatory Compliance"
                  placeholder="Outline the legal and regulatory requirements relevant to your business. Include information on licenses, permits, and compliance with industry regulations."
                  [rows]="4"
                  formControlName="regulatoryCompliance"
                />
              </form>
            }
            
            @case ('real-estate') {
              <form [formGroup]="section.form" class="space-y-6">
                <ui-textarea
                  label="Real Estate Holdings"
                  placeholder="Provide details on the real estate your business owns or leases. Include information on locations, facilities, and any real estate-related plans or strategies."
                  [rows]="4"
                  formControlName="realEstateDetails"
                />
                
                <ui-textarea
                  label="Property Portfolio"
                  placeholder="List your current properties and their use in business operations, including lease terms and strategic importance."
                  [rows]="3"
                  formControlName="propertyPortfolio"
                />
                
                <ui-textarea
                  label="Expansion Plans"
                  placeholder="Describe any plans for expanding or changing your real estate footprint as part of your growth strategy."
                  [rows]="3"
                  formControlName="expansionPlans"
                />
              </form>
            }
          }
        </ui-section-card>
      }

      <!-- Overall Progress -->
      <ui-card>
        <div class="flex items-center justify-between">
          <div>
            <h3 class="font-semibold text-neutral-900">Business Plan Progress</h3>
            <p class="text-sm text-neutral-600">
              {{ completedSections() }} of {{ totalSections() }} sections completed
            </p>
          </div>
          
          @if (allSectionsCompleted()) {
            <div class="flex items-center space-x-2 text-green-600">
              <div class="w-2 h-2 bg-green-500 rounded-full"></div>
              <span class="font-medium">Ready to submit</span>
            </div>
          } @else {
            <div class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">
              {{ totalSections() - completedSections() }} sections remaining
            </div>
          }
        </div>
      </ui-card>
    </div>

    <!-- Hidden file input -->
    <input
      #fileInput
      type="file"
      accept=".pdf,.doc,.docx"
      (change)="onFileSelected($event)"
      class="hidden"
    />