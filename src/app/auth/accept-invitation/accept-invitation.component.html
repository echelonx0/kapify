<div
  class="min-h-screen bg-slate-50 flex items-center justify-center px-4 py-8"
>
  <div class="w-full max-w-md">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-slate-900 mb-2">Join Team</h1>
      <p class="text-slate-600">
        Complete your registration to accept the invitation
      </p>
    </div>

    <!-- Validating State -->
    @if (isValidating()) {
    <div class="bg-white rounded-2xl border border-slate-200 p-8 text-center">
      <div
        class="animate-spin w-8 h-8 border-2 border-teal-500 border-t-transparent rounded-full mx-auto"
      ></div>
      <p class="text-slate-600 mt-4 text-sm">Validating invitation...</p>
    </div>
    }

    <!-- Success State -->
    @if (success()) {
    <div
      class="bg-green-50 rounded-2xl border border-green-200/50 p-8 text-center"
    >
      <lucide-icon
        name="check-circle-2"
        [size]="48"
        class="text-green-600 mx-auto mb-4"
      />
      <h2 class="text-lg font-bold text-green-900 mb-2">
        Welcome to the Team!
      </h2>
      <p class="text-green-700 text-sm">Redirecting you to the dashboard...</p>
    </div>
    }

    <!-- Error State -->
    @if (error() && !isValidating() && !success()) {
    <div class="bg-red-50 rounded-2xl border border-red-200/50 p-4 mb-6">
      <div class="flex items-start gap-3">
        <lucide-icon
          name="alert-circle"
          [size]="20"
          class="text-red-600 flex-shrink-0 mt-0.5"
        />
        <p class="text-red-700 text-sm">{{ error() }}</p>
      </div>
    </div>
    }

    <!-- Form -->
    @if (!isValidating() && !success() && invitationDetails()) {
    <form
      [formGroup]="form"
      (ngSubmit)="onSubmit()"
      class="bg-white rounded-2xl border border-slate-200 p-6 space-y-4"
    >
      <!-- Organization & Role Info -->
      <div class="bg-teal-50 rounded-xl border border-teal-200/50 p-4 mb-6">
        <p class="text-sm text-teal-900">
          <span class="font-semibold">{{
            invitationDetails()?.organizationName
          }}</span>
          has invited you to join as a
          <span class="font-semibold capitalize">{{
            invitationDetails()?.role
          }}</span>
        </p>
        <p class="text-xs text-teal-700 mt-2">
          Invited by {{ invitationDetails()?.inviterName }}
        </p>
      </div>

      <!-- First Name -->
      <div>
        <label class="block text-sm font-semibold text-slate-900 mb-2">
          First Name <span class="text-red-600">*</span>
        </label>
        <input
          type="text"
          formControlName="firstName"
          placeholder="John"
          class="w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all duration-200"
        />
        @if (form.get('firstName')?.invalid && form.get('firstName')?.touched) {
        <p class="text-red-600 text-xs mt-1">
          {{ getFirstNameErrorMessage() }}
        </p>
        }
      </div>

      <!-- Last Name -->
      <div>
        <label class="block text-sm font-semibold text-slate-900 mb-2">
          Last Name <span class="text-red-600">*</span>
        </label>
        <input
          type="text"
          formControlName="lastName"
          placeholder="Doe"
          class="w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all duration-200"
        />
        @if (form.get('lastName')?.invalid && form.get('lastName')?.touched) {
        <p class="text-red-600 text-xs mt-1">{{ getLastNameErrorMessage() }}</p>
        }
      </div>

      <!-- Email (Disabled) -->
      <div>
        <label class="block text-sm font-semibold text-slate-900 mb-2"
          >Email</label
        >
        <input
          type="email"
          formControlName="email"
          class="w-full px-4 py-2.5 border border-slate-200 rounded-xl bg-slate-50 cursor-not-allowed text-slate-600"
        />
        <p class="text-xs text-slate-500 mt-1">
          This email was invited and cannot be changed
        </p>
      </div>

      <!-- Password -->
      <div>
        <label class="block text-sm font-semibold text-slate-900 mb-2">
          Password <span class="text-red-600">*</span>
        </label>
        <input
          type="password"
          formControlName="password"
          placeholder="••••••••"
          class="w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all duration-200"
        />
        @if (getPasswordErrorMessage()) {
        <p class="text-red-600 text-xs mt-1">{{ getPasswordErrorMessage() }}</p>
        }
      </div>

      <!-- Confirm Password -->
      <div>
        <label class="block text-sm font-semibold text-slate-900 mb-2">
          Confirm Password <span class="text-red-600">*</span>
        </label>
        <input
          type="password"
          formControlName="confirmPassword"
          placeholder="••••••••"
          class="w-full px-4 py-2.5 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent transition-all duration-200"
        />
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        [disabled]="isSubmitting() || form.invalid"
        class="w-full bg-teal-500 text-white font-medium rounded-xl px-6 py-2.5 hover:bg-teal-600 active:bg-teal-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed mt-6"
      >
        @if (isSubmitting()) {
        <span class="flex items-center justify-center gap-2">
          <div
            class="animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"
          ></div>
          Creating Account...
        </span>
        } @else { Accept & Join }
      </button>
    </form>
    }

    <!-- Already have account link -->
    <p class="text-center text-sm text-slate-600 mt-4">
      Already have an account?
      <a
        href="/auth/login"
        class="text-teal-600 hover:text-teal-700 font-medium"
        >Sign in</a
      >
    </p>
  </div>
</div>
