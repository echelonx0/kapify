<div class="min-h-screen flex relative">
  <!-- Top-right header (moved here from form panel) -->
  <div class="absolute top-6 right-8 flex items-center space-x-6 z-40">
    <div class="flex items-center space-x-3">
      <div
        class="w-10 h-10 bg-primary-600 rounded-xl flex items-center justify-center shadow-md"
      >
        <span class="text-white font-bold text-lg">K</span>
      </div>
      <h1 class="text-2xl font-bold text-white drop-shadow-md">Join Kapify</h1>
    </div>
    <a
      routerLink="/login"
      class="text-sm text-white font-medium border border-white/30 hover:border-white bg-white/10 hover:bg-white/20 transition-all px-4 py-1.5 rounded-full shadow-sm backdrop-blur-sm"
    >
      Sign in
    </a>
  </div>

  <!-- Left Panel - Form -->
  <div class="flex-1 flex items-center justify-center px-8 py-12 bg-white">
    <div class="w-full max-w-md">
      <!-- ðŸ§© Removed the old header section from here -->

      <!-- Form -->
      <form
        [formGroup]="registerForm"
        (ngSubmit)="onSubmit()"
        class="space-y-6"
      >
        <!-- User Type Selection -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-neutral-700 mb-3"
            >Register as</label
          >
          <div class="grid grid-cols-2 gap-4">
            <button
              type="button"
              [class]="
                getUserTypeButtonClasses('sme') +
                ' bg-white hover:bg-primary-50 border border-slate-200 rounded-lg p-4 flex flex-col items-center justify-center shadow-sm hover:shadow-md transition-all'
              "
              (click)="selectUserType('sme')"
            >
              <div class="font-medium text-sm text-neutral-900">
                Business Owner
              </div>
              <div class="text-xs text-neutral-500 mt-1 text-center">
                I need funding
              </div>
            </button>
            <button
              type="button"
              [class]="
                getUserTypeButtonClasses('funder') +
                ' bg-white hover:bg-primary-50 border border-slate-200 rounded-lg p-4 flex flex-col items-center justify-center shadow-sm hover:shadow-md transition-all'
              "
              (click)="selectUserType('funder')"
            >
              <div class="font-medium text-sm text-neutral-900">Investor</div>
              <div class="text-xs text-neutral-500 mt-1 text-center">
                I provide funding
              </div>
            </button>
          </div>
        </div>

        <!-- Rest of your form untouched -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2"
              >First name</label
            >
            <input
              type="text"
              formControlName="firstName"
              placeholder="John"
              [class]="getInputClasses('firstName')"
            />
            @if (getFieldError('firstName')) {
            <p class="mt-1 text-sm text-red-600">
              {{ getFieldError("firstName") }}
            </p>
            }
          </div>
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2"
              >Last name</label
            >
            <input
              type="text"
              formControlName="lastName"
              placeholder="Doe"
              [class]="getInputClasses('lastName')"
            />
            @if (getFieldError('lastName')) {
            <p class="mt-1 text-sm text-red-600">
              {{ getFieldError("lastName") }}
            </p>
            }
          </div>
        </div>

        <!-- ... rest of form unchanged ... -->

        <!-- Email -->
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2"
            >Email address</label
          >
          <input
            type="email"
            formControlName="email"
            placeholder="john@company.co.za"
            [class]="getInputClasses('email')"
          />
          @if (getFieldError('email')) {
          <p class="mt-1 text-sm text-red-600">{{ getFieldError("email") }}</p>
          }
        </div>

        <!-- Phone -->
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2"
            >Phone number</label
          >
          <input
            type="tel"
            formControlName="phone"
            placeholder="+27 81 123 4567"
            [class]="getInputClasses('phone')"
          />
          @if (getFieldError('phone')) {
          <p class="mt-1 text-sm text-red-600">{{ getFieldError("phone") }}</p>
          }
        </div>

        <!-- Company Name (SME only) -->
        @if (selectedUserType() === 'sme') {
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2"
            >Company name</label
          >
          <input
            type="text"
            formControlName="companyName"
            placeholder="Your Company (Pty) Ltd"
            [class]="getInputClasses('companyName')"
          />
          @if (getFieldError('companyName')) {
          <p class="mt-1 text-sm text-red-600">
            {{ getFieldError("companyName") }}
          </p>
          }
        </div>
        }

        <!-- Password -->
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2"
            >Password</label
          >
          <div class="relative">
            <input
              [type]="showPassword() ? 'text' : 'password'"
              formControlName="password"
              placeholder="Create a strong password"
              [class]="getInputClasses('password')"
            />
            <button
              type="button"
              class="absolute right-3 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors"
              (click)="togglePasswordVisibility()"
            >
              <lucide-icon
                [img]="showPassword() ? EyeOffIcon : EyeIcon"
                [size]="20"
              />
            </button>
          </div>
          @if (getFieldError('password')) {
          <p class="mt-1 text-sm text-red-600">
            {{ getFieldError("password") }}
          </p>
          }
          <p class="mt-1 text-sm text-neutral-500">
            Must be at least 8 characters
          </p>
        </div>

        <!-- Confirm Password -->
        <div>
          <label class="block text-sm font-medium text-neutral-700 mb-2"
            >Confirm password</label
          >
          <div class="relative">
            <input
              [type]="showConfirmPassword() ? 'text' : 'password'"
              formControlName="confirmPassword"
              placeholder="Confirm your password"
              [class]="getInputClasses('confirmPassword')"
            />
            <button
              type="button"
              class="absolute right-3 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600 transition-colors"
              (click)="toggleConfirmPasswordVisibility()"
            >
              <lucide-icon
                [img]="showConfirmPassword() ? EyeOffIcon : EyeIcon"
                [size]="20"
              />
            </button>
          </div>
          @if (getFieldError('confirmPassword')) {
          <p class="mt-1 text-sm text-red-600">
            {{ getFieldError("confirmPassword") }}
          </p>
          }
        </div>

        <!-- Error Message -->
        @if (error()) {
        <div
          class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"
        >
          {{ error() }}
        </div>
        }

        <!-- Submit Button -->
        <button
          type="submit"
          [disabled]="registerForm.invalid || isLoading()"
          class="w-full bg-primary-600 hover:bg-primary-700 disabled:bg-primary-300 text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 flex items-center justify-center"
        >
          @if (isLoading()) {
          <div
            class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"
          ></div>
          <span class="ml-2">Creating account...</span>
          } @else {
          <span>I confirm. Create my account</span>
          <!-- <lucide-icon [img]="ArrowRightIcon" [size]="20" class="ml-2" /> -->
          }
        </button>
      </form>

      <!-- Terms / Privacy Text -->
      <div class="mt-2 text-justify text-xs text-slate-700">
        Please review our
        <a
          href="/privacy"
          class="text-slate-700 font-medium hover:text-slate-900"
          >Privacy Policy</a
        >
        and
        <a href="/terms" class="text-slate-700 font-medium hover:text-slate-900"
          >Data Protection Policy</a
        >
        before using this platform. By logging in and continuing to use our
        services, you confirm that you have read, understood, and accepted our
        Privacy Policy. You also consent to the handling, storage, and sharing
        of your data strictly in accordance with these policies, and understand
        that your data will only be used within the platform as outlined.
      </div>
    </div>
  </div>

  <!-- Right Panel - Slideshow -->
  <div class="hidden lg:block flex-1 relative overflow-hidden">
    <ng-container *ngFor="let slide of slides(); let i = index">
      <img
        [src]="slide.image"
        [alt]="slide.title || 'slide-' + i"
        class="absolute inset-0 w-full h-full object-cover transition-opacity duration-700"
        [ngClass]="{
          'opacity-100 z-20': activeSlideIndex() === i,
          'opacity-0 z-10': activeSlideIndex() !== i
        }"
        (mouseenter)="stopAutoplay()"
        (mouseleave)="startAutoplay()"
      />
    </ng-container>

    <div
      class="absolute inset-0 pointer-events-none bg-gradient-to-t from-black/55 via-black/30 to-transparent"
    ></div>

    <div class="absolute left-8 bottom-12 max-w-lg text-white z-30">
      <h2 class="text-3xl md:text-4xl font-serif leading-tight drop-shadow-md">
        {{ slides()[activeSlideIndex()].title }}
      </h2>
      <p class="mt-3 text-sm md:text-base text-white/90 max-w-md">
        {{ slides()[activeSlideIndex()].subtitle }}
      </p>

      <div class="mt-6 flex items-center space-x-4">
        <div class="flex items-center space-x-2">
          <button
            *ngFor="let s of slides(); let idx = index"
            (click)="selectSlide(idx); stopAutoplay()"
            [attr.aria-label]="'Go to slide ' + (idx + 1)"
            class="w-3 h-3 rounded-full transform transition-all duration-200"
            [ngClass]="{
              'scale-125 bg-white': activeSlideIndex() === idx,
              'bg-white/40 hover:bg-white/60': activeSlideIndex() !== idx
            }"
          ></button>
        </div>

        <div class="ml-4 flex items-center space-x-2">
          <button
            (click)="prevSlide(); stopAutoplay()"
            class="px-3 py-2 rounded-md bg-white/10 hover:bg-white/20 text-white text-sm"
          >
            â€¹
          </button>
          <button
            (click)="nextSlide(); stopAutoplay()"
            class="px-3 py-2 rounded-md bg-white/10 hover:bg-white/20 text-white text-sm"
          >
            â€º
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
