<!-- src/app/funder/onboarding-welcome/organization-onboarding.component.html -->
<div
  class="h-screen bg-gradient-to-br from-slate-50 via-slate-50 to-indigo-50 flex flex-col overflow-hidden"
>
  <!-- Main Container -->
  <div class="flex-1 flex flex-col lg:flex-row overflow-hidden min-h-0">
    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col min-w-0 overflow-hidden">
      <!-- Mobile Header Component -->
      <app-mobile-header
        [greeting]="getGreeting()"
        [userName]="getUserName()"
        [currentDate]="getCurrentDateFormatted()"
        [userInitials]="getUserInitials()"
      />

      <!-- Content Router - Fixed height with no scrolling -->
      <div class="flex-1 overflow-hidden min-h-0">
        @switch (currentView()) { @case ('setup') {
        <app-setup-state
          (startSetup)="startSetup()"
          (loadExisting)="loadFromExisting()"
        />
        } @case ('ready-verification') {
        <app-verification-ready-state
          [onboardingState]="onboardingState()"
          [isSaving]="onboardingService.isSaving()"
          [completionPercentage]="getCompletionPercentage()"
          (requestVerification)="requestVerification()"
          (skipVerification)="skipVerification()"
          (createOpportunity)="createFirstOpportunity()"
          (goToDashboard)="proceedToDashboard()"
        />
        } @case ('pending-verification') {
        <app-pending-verification-state
          [verificationDate]="getVerificationDate()"
          (goToDashboard)="proceedToDashboard()"
          (createOpportunity)="createFirstOpportunity()"
        />
        } @case ('verified') {
        <app-verified-state
          [verificationDate]="getVerificationDate()"
          (createOpportunity)="createFirstOpportunity()"
          (browseSMEs)="browseSMEs()"
          (goToDashboard)="proceedToDashboard()"
        />
        } @case ('rejected') {
        <!-- Rejected State - Fixed height -->
        <div
          class="h-full flex items-center justify-center p-4 lg:p-6 overflow-hidden"
        >
          <div class="w-full max-w-3xl mx-auto text-center">
            <div
              class="w-16 h-16 bg-gradient-to-br from-red-500 to-rose-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg"
            >
              <lucide-icon
                [img]="AlertCircleIcon"
                [size]="28"
                class="text-white"
              />
            </div>

            <h1 class="text-xl lg:text-2xl font-bold text-slate-900 mb-3">
              Verification Needs Attention
            </h1>
            <p class="text-sm lg:text-base text-slate-600 mb-4">
              We need additional information to complete your verification. This
              is common and easily resolved.
            </p>

            <!-- Issue Details - Scrollable if needed -->
            <div
              class="bg-red-50 border border-red-200 rounded-xl p-4 mb-4 max-h-32 overflow-y-auto"
            >
              <h3 class="text-base font-semibold text-red-900 mb-2">
                What needs to be updated:
              </h3>
              <div class="text-left space-y-2">
                <div class="flex items-start space-x-3">
                  <div
                    class="w-5 h-5 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5"
                  >
                    <lucide-icon
                      [img]="AlertCircleIcon"
                      [size]="12"
                      class="text-red-600"
                    />
                  </div>
                  <div>
                    <h4 class="font-semibold text-red-900 text-sm">
                      Documentation
                    </h4>
                    <p class="text-xs text-red-700">
                      Please provide clearer copies of registration documents
                    </p>
                  </div>
                </div>

                <div class="flex items-start space-x-3">
                  <div
                    class="w-5 h-5 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5"
                  >
                    <lucide-icon
                      [img]="AlertCircleIcon"
                      [size]="12"
                      class="text-red-600"
                    />
                  </div>
                  <div>
                    <h4 class="font-semibold text-red-900 text-sm">
                      Contact Verification
                    </h4>
                    <p class="text-xs text-red-700">
                      We need to verify your business phone number
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="space-y-2 mb-3">
              <button
                class="w-full bg-slate-600 hover:bg-slate-700 text-white font-medium py-2.5 px-6 rounded-lg transition-colors text-sm"
                (click)="editOrganization()"
              >
                Update Information
              </button>

              <button
                class="w-full border border-slate-300 hover:border-slate-400 text-slate-700 font-medium py-2.5 px-6 rounded-lg transition-colors text-sm"
                (click)="skipVerification()"
              >
                Continue Without Verification
              </button>
            </div>

            <!-- Support Contact -->
            <div class="bg-slate-50 border border-slate-200 rounded-lg p-3">
              <h4 class="font-semibold text-slate-900 mb-1 text-sm">
                Need Help?
              </h4>
              <p class="text-xs text-slate-800 mb-2">
                Our verification team is here to help you through this process.
              </p>
              <button
                class="text-xs text-slate-600 hover:text-slate-700 font-medium"
              >
                Contact Support Team
              </button>
            </div>
          </div>
        </div>
        } }
      </div>
    </div>
  </div>

  <!-- Error Display -->
  @if (onboardingService.error()) {
  <div class="fixed bottom-6 right-6 max-w-sm z-50">
    <div class="bg-red-50 border border-red-200 rounded-xl p-4 shadow-lg">
      <div class="flex items-start space-x-3">
        <lucide-icon
          [img]="AlertCircleIcon"
          [size]="16"
          class="text-red-600 flex-shrink-0 mt-0.5"
        />
        <p class="text-sm text-red-800">{{ onboardingService.error() }}</p>
      </div>
    </div>
  </div>
  }
</div>
