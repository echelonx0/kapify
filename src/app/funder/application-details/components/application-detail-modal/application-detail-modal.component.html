<!-- Backdrop -->
<div
  *ngIf="isOpen()"
  (click)="close()"
  class="fixed inset-0 bg-black/25 backdrop-blur-sm z-40 transition-opacity duration-300"
></div>

<!-- Modal -->
<div
  *ngIf="isOpen()"
  class="fixed right-0 top-0 h-screen w-full md:w-96 bg-white shadow-xl z-50 overflow-y-auto transition-transform duration-300"
>
  <!-- Header -->
  <div
    class="sticky top-0 z-10 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between"
  >
    <div class="flex items-center gap-3">
      <h3 class="text-lg font-bold text-slate-900">Funding Request</h3>
    </div>
    <button
      (click)="close()"
      class="text-slate-600 hover:text-slate-900 transition-colors"
    >
      <div
        class="w-10 h-10 rounded-lg bg-teal-100 flex items-center justify-center"
      >
        <lucide-angular [img]="CloseIcon" size="20"></lucide-angular>
      </div>
    </button>
  </div>

  <!-- Content -->
  <div class="p-6 space-y-6">
    @if (hasFundingRequest()) {
    <div class="bg-teal-50 rounded-xl border border-teal-200/50 p-4">
      <div class="grid grid-cols-2 gap-x-4 gap-y-3 text-sm">
        <!-- Industry Vertical -->
        @if (getCurrentData()?.fundingRequest?.industries?.length) {
        <div class="text-slate-600 font-medium">Industry Vertical</div>
        <div class="flex flex-wrap gap-1">
          @for (industry of getCurrentData()?.fundingRequest?.industries; track
          industry) {
          <span
            class="inline-block px-2 py-1 bg-teal-100 text-teal-700 rounded text-xs font-medium"
          >
            {{ industry }}
          </span>
          }
        </div>
        }

        <!-- Funding Amount -->
        @if (getCurrentData()?.fundingRequest?.fundingAmount) {
        <div class="text-slate-600 font-medium">Funding Amount</div>
        <div class="font-semibold text-slate-900">
          {{
            formatCurrency(
              getCurrentData()?.fundingRequest?.fundingAmount || 0,
              getCurrentData()?.currency
            )
          }}
        </div>
        }

        <!-- Funding Types -->
        @if (getCurrentData()?.fundingRequest?.fundingTypes?.length) {
        <div class="text-slate-600 font-medium">Funding Types</div>
        <div class="flex flex-wrap gap-1">
          @for (type of getCurrentData()?.fundingRequest?.fundingTypes; track
          type) {
          <span
            class="inline-block px-2 py-1 rounded text-xs font-semibold border"
            [class]="getFundingTypeColor(type)"
          >
            {{ formatFundingType(type) }}
          </span>
          }
        </div>
        }

        <!-- Business Stages -->
        @if (getCurrentData()?.fundingRequest?.businessStages?.length) {
        <div class="text-slate-600 font-medium">Business Stages</div>
        <div class="flex flex-wrap gap-1">
          @for (stage of getCurrentData()?.fundingRequest?.businessStages; track
          stage) {
          <span
            class="inline-block px-2 py-1 bg-slate-100 text-slate-700 rounded text-xs font-medium"
          >
            {{ stage }}
          </span>
          }
        </div>
        }

        <!-- Location -->
        @if (getCurrentData()?.fundingRequest?.location) {
        <div class="text-slate-600 font-medium">Location</div>
        <div class="font-medium text-slate-900">
          {{ getCurrentData()?.fundingRequest?.location }}
        </div>
        }

        <!-- Use of Funds -->
        @if (getCurrentData()?.fundingRequest?.useOfFunds) {
        <div class="text-slate-600 font-medium">Use of Funds</div>
        <div class="font-medium text-slate-900 text-xs">
          {{ getCurrentData()?.fundingRequest?.useOfFunds }}
        </div>
        }

        <!-- Funding Motivation -->
        @if (getCurrentData()?.fundingRequest?.fundingMotivation) {
        <div class="text-slate-600 font-medium">Funding Motivation</div>
        <div class="font-medium text-slate-900 text-xs">
          {{ getCurrentData()?.fundingRequest?.fundingMotivation }}
        </div>
        }

        <!-- Equity Offered -->
        @if (getCurrentData()?.fundingRequest?.equityOffered) {
        <div class="text-slate-600 font-medium">Equity Offered</div>
        <div class="font-semibold text-slate-900">
          {{ getCurrentData()?.fundingRequest?.equityOffered }}%
        </div>
        }
      </div>
    </div>
    }

    <!-- Status & Stage -->
    <div class="space-y-3">
      <div class="space-y-2 text-sm">
        <div
          class="flex justify-between items-center py-2 border-b border-slate-100"
        >
          <span class="text-slate-600">Status</span>
          <span class="font-medium text-slate-900">{{
            getCurrentData()?.status
          }}</span>
        </div>

        @if (getCurrentData()?.submittedAt) {
        <div
          class="flex justify-between items-center py-2 border-b border-slate-100"
        >
          <span class="text-slate-600">Submitted</span>
          <span class="font-medium text-slate-900">
            {{ formatDate(getCurrentData()?.submittedAt) }}
          </span>
        </div>
        }
      </div>
    </div>

    <!-- Actions -->
    <div class="flex items-center gap-3 pt-6 border-t border-slate-200">
      <button
        (click)="close()"
        class="flex-1 bg-slate-100 text-slate-700 font-medium py-2.5 rounded-xl hover:bg-slate-200 transition-colors duration-200"
      >
        Close
      </button>
    </div>
  </div>
</div>
